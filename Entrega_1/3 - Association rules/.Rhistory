library(arules)
library(arulesViz)
library(FactoMineR)
library(tidyverse)
# THE TIC 2002 SURVEY
# READING THE DATA
tic_tt <- read.csv("C:/Users/marag/Downloads/tic_tt2.csv",header=T, stringsAsFactors = TRUE)
dim(tic_tt)
str(tic_tt)
summary(tic_tt)
row.names(tic_tt) <- tic_tt[,1]
tic_tt <- tic_tt[,-1]
str(tic_tt)
for (j in 1:ncol(tic_tt)) {if(class(tic_tt[,j])=="logical") tic_tt[,j]<- as.factor(tic_tt[,j])}
summary(tic_tt)
str(tic_tt)
### TRANSFORMATION OF THE DB INTO A TRANSACTIONAL DB
ttr2 <- as(tic_tt,"transactions")
# HOW MANY TRANSACTIONS AND ITEMS?
ttr2
# SUMMARY OF ttr2
summary(ttr2)
class(ttr2)
load("~/GitHub/Mineria/DATA/dataaaaaaaaaaaaaa.RData")
library(arules)
library(dplyr)
data_ar <- subset(data_transformada, select = -c(Surname, ID, group))
data_ar <- data_ar %>%
filter(!is.na(Exited))
str(data_ar)
data_ar <- data_ar %>%
mutate(across(where(is.character), as.factor))
data_ar <- data_ar %>%
mutate(
Tenure = cut(Tenure,
breaks = c(0, 3, 6, 10),
labels = c("Nuevo (0-3 años)", "Medio (4-6 años)", "Antiguo (7-10 años)"),
include.lowest = TRUE)
)
data_ar <- data_ar %>%
mutate(
NetPromoterScore = cut(NetPromoterScore,
breaks = c(-1, 6, 8, 10),  # -1 para incluir el 0
labels = c("0-6", "7-8", "9-10"),
include.lowest = TRUE)
)
data_ar <- data_ar %>%
mutate(
TransactionFrequency = cut(TransactionFrequency,
breaks = c(0, 20, 30, 40, max(TransactionFrequency, na.rm = TRUE)),
labels = c("0-20", "21-30", "31-40", "41+"),
include.lowest = TRUE)
)
data_ar <- data_ar %>%
mutate(
Age = cut(Age,
breaks = c(0, 25, 35, 45, 55, 65, 100),
labels = c("18-25", "26-35", "36-45", "46-55", "56-65", "65+"),
include.lowest = TRUE)
)
data_ar <- data_ar %>%
mutate(
EstimatedSalary = cut(EstimatedSalary,
breaks = c(0, 30000, 60000, 90000, 120000, 150000, 180000,
max(EstimatedSalary, na.rm = TRUE)),
labels = c("0-30K", "31-60K", "61-90K", "91-120K",
"121-150K", "151-180K", "180K+"),
include.lowest = TRUE)
)
data_ar <- data_ar %>%
mutate(
AvgTransactionAmount = cut(AvgTransactionAmount,
breaks = quantile(AvgTransactionAmount,
probs = c(0, 0.5, 0.8, 0.95, 1),
na.rm = TRUE),
labels = c("Bajo (0-50%)", "Medio (51-80%)",
"Alto (81-95%)", "Muy Alto (96-100%)"),
include.lowest = TRUE)
)
data_ar <- data_ar %>%
mutate(
DigitalEngagementScore = cut(DigitalEngagementScore,
breaks = c(0, 25, 50, 75, 100),
labels = c("0-25", "26-50", "51-75", "76-100"),
include.lowest = TRUE)
)
data_ar <- data_ar %>%
mutate(
CreditScore = cut(CreditScore,
breaks = c(300, 580, 670, 740, 800, 850),
labels = c("Muy Bajo (300-579)", "Bajo (580-669)",
"Medio (670-739)", "Bueno (740-799)",
"Excelente (800-850)"),
include.lowest = TRUE)
)
data_ar <- data_ar %>%
mutate(
Balance = cut(Balance,
breaks = c(0, 1000, 5000, 15000, 50000, Inf),
labels = c("Muy Bajo (0-1K)", "Bajo (1-5K)",
"Medio (5-15K)", "Alto (15-50K)",
"Muy Alto (50K+)"),
include.lowest = TRUE)
)
str(data_ar)
data_tr <- as(data_ar,"transactions")
data_tr
inspect(data_tr[1:2])
SIZE <- size(data_tr)
summary(SIZE)
itemFrequencyPlot(data_tr, topN=100,type="absolute", cex.names = 0.6)
itemsets <- apriori(data = data_tr,
parameter = list(support = 0.05,
minlen = 1,
maxlen = 5,
target = "frequent itemset"))
summary(itemsets)
top_5_itemsets <- sort(itemsets, by = "support", decreasing = TRUE)[1:5]
(inspect(top_5_itemsets))
rules = apriori (data_tr, parameter = list (support=0.025, confidence=0.75, maxlen = 5, minlen=2))
summary(rules)
filtrado_reglas <- subset(x = rules,
subset = rhs %pin% "Exited=1")
filtrado_reglas_ordenadas <- sort(filtrado_reglas, by = "lift")
inspect(head(filtrado_reglas_ordenadas,10))
filtrado_reglas <- subset(x = rules,
subset = rhs %pin% "Exited=0")
filtrado_reglas_ordenadas <- sort(filtrado_reglas, by = "lift")
inspect(filtrado_reglas_ordenadas)
inspect(head(filtrado_reglas_ordenadas,5))
filtrado_reglas <- subset(x = rules,
subset = rhs %pin% "Exited=1")
filtrado_reglas_ordenadas <- sort(filtrado_reglas, by = "lift")
inspect(head(filtrado_reglas_ordenadas,10))
filtrado_reglas <- subset(x = rules,
subset = rhs %pin% "Exited=0")
filtrado_reglas_ordenadas <- sort(filtrado_reglas, by = "lift")
inspect(head(filtrado_reglas_ordenadas,5))
rules = apriori (data_tr, parameter = list (support=0.05, confidence=0.50, maxlen = 5, minlen=2))
summary(rules)
filtrado_reglas <- subset(x = rules,
subset = rhs %pin% "Exited=1")
filtrado_reglas_ordenadas <- sort(filtrado_reglas, by = "lift")
inspect(head(filtrado_reglas_ordenadas,10))
rules = apriori (data_tr, parameter = list (support=0.025, confidence=0.50, maxlen = 5, minlen=2))
filtrado_reglas <- subset(x = rules,
subset = rhs %pin% "Exited=1")
filtrado_reglas <- subset(x = rules,
subset = rhs %pin% "Exited=1")
filtrado_reglas_ordenadas <- sort(filtrado_reglas, by = "lift")
inspect(head(filtrado_reglas_ordenadas,10))
table(data_transformada$Exited)
prop.table(data_transformada$Exited)
1450/(1450+5550)
rules = apriori (data_tr, parameter = list (support=0.025, confidence=0.80, maxlen = 5, minlen=2))
summary(rules)
rules = apriori (data_tr, parameter = list (support=0.05, confidence=0.80, maxlen = 5, minlen=2))
summary(rules)
filtrado_reglas <- subset(x = rules,
subset = rhs %pin% "Exited=1")
inspect(head(filtrado_reglas_ordenadas,10))
rules = apriori (data_tr, parameter = list (support=0.05, confidence=0.80, maxlen = 5, minlen=2))
summary(rules)
filtrado_reglas <- subset(x = rules,
subset = rhs %pin% "Exited=1")
filtrado_reglas_ordenadas <- sort(filtrado_reglas, by = "lift")
inspect(head(filtrado_reglas_ordenadas,10))
reglas_Noredund <- rules[!is.redundant(x = rules, measure = "confidence")]
reglas_Noredund
filtrado_reglas <- subset(x = reglas_Noredund,
subset = rhs %pin% "Exited=1")
filtrado_reglas_ordenadas <- sort(filtrado_reglas, by = "lift")
inspect(head(filtrado_reglas_ordenadas,10))
rules = apriori (data_tr, parameter = list (support=0.05, confidence=0.50, maxlen = 5, minlen=2))
summary(rules)
reglas_Noredund <- rules[!is.redundant(x = rules, measure = "confidence")]
reglas_Noredund <- rules[!is.redundant(x = rules, measure = "confidence")]
filtrado_reglas <- subset(x = reglas_Noredund,
subset = rhs %pin% "Exited=1")
filtrado_reglas_ordenadas <- sort(filtrado_reglas, by = "lift")
inspect(head(filtrado_reglas_ordenadas,10))
rules = apriori (data_tr, parameter = list (support=0.05, confidence=0.50, maxlen = 5, minlen=2))
summary(rules)
reglas_Noredund <- rules[!is.redundant(x = rules, measure = "confidence")]
reglas_Noredund <- rules[!is.redundant(x = rules, measure = "confidence")]
filtrado_reglas <- subset(x = reglas_Noredund,
subset = rhs %pin% "Exited=1")
filtrado_reglas_ordenadas <- sort(filtrado_reglas, by = "lift")
filtrado_reglas_ordenadas <- sort(filtrado_reglas, by = "lift")
inspect(head(filtrado_reglas_ordenadas,10))
rules = apriori (data_tr, parameter = list (support=0.025, confidence=0.50, maxlen = 5, minlen=2))
rules = apriori (data_tr, parameter = list (support=0.025, confidence=0.50, maxlen = 5, minlen=2))
summary(rules)
reglas_Noredund <- rules[!is.redundant(x = rules, measure = "confidence")]
filtrado_reglas <- subset(x = reglas_Noredund,
subset = rhs %pin% "Exited=1")
filtrado_reglas_ordenadas <- sort(filtrado_reglas, by = "lift")
inspect(head(filtrado_reglas_ordenadas,10))
rules = apriori (data_tr, parameter = list (support=0.025, confidence=0.50, maxlen = 5, minlen=2))
rules = apriori (data_tr, parameter = list (support=0.025, confidence=0.50, maxlen = 5, minlen=2))
summary(rules)
reglas_Noredund <- rules[!is.redundant(x = rules, measure = "confidence")]
reglas_Noredund <- rules[!is.redundant(x = rules, measure = "confidence")]
filtrado_reglas <- subset(x = reglas_Noredund,
subset = rhs %pin% "Exited=1")
filtrado_reglas_ordenadas <- sort(filtrado_reglas, by = "lift")
inspect(head(filtrado_reglas_ordenadas,10))
rules = apriori (data_tr, parameter = list (support=0.1, confidence=0.95, maxlen = 5, minlen=2))
summary(rules)
reglas_Noredund <- rules[!is.redundant(x = rules, measure = "confidence")]
filtrado_reglas <- subset(x = reglas_Noredund,
subset = rhs %pin% "Exited=0")
filtrado_reglas_ordenadas <- sort(filtrado_reglas, by = "lift")
inspect(head(filtrado_reglas_ordenadas,10))
rules = apriori (data_tr, parameter = list (support=0.1, confidence=0.90, maxlen = 5, minlen=2))
summary(rules)
reglas_Noredund <- rules[!is.redundant(x = rules, measure = "confidence")]
filtrado_reglas <- subset(x = reglas_Noredund,
subset = rhs %pin% "Exited=0")
filtrado_reglas_ordenadas <- sort(filtrado_reglas, by = "lift")
inspect(head(filtrado_reglas_ordenadas,10))
rules = apriori (data_tr, parameter = list (support=0.5, confidence=0.90, maxlen = 5, minlen=2))
summary(rules)
reglas_Noredund <- rules[!is.redundant(x = rules, measure = "confidence")]
filtrado_reglas <- subset(x = reglas_Noredund,
subset = rhs %pin% "Exited=0")
filtrado_reglas_ordenadas <- sort(filtrado_reglas, by = "lift")
inspect(head(filtrado_reglas_ordenadas,10))
reglas_Noredund <- rules[!is.redundant(x = rules, measure = "confidence")]
filtrado_reglas <- subset(x = reglas_Noredund,
subset = rhs %pin% "Exited=0")
filtrado_reglas_ordenadas <- sort(filtrado_reglas, by = "lift")
inspect(head(filtrado_reglas_ordenadas,10))
rules = apriori (data_tr, parameter = list (support=0.05, confidence=0.90, maxlen = 5, minlen=2))
summary(rules)
reglas_Noredund <- rules[!is.redundant(x = rules, measure = "confidence")]
filtrado_reglas <- subset(x = reglas_Noredund,
subset = rhs %pin% "Exited=0")
inspect(head(filtrado_reglas_ordenadas,10))
rules = apriori (data_tr, parameter = list (support=0.05, confidence=0.90, maxlen = 5, minlen=2))
rules = apriori (data_tr, parameter = list (support=0.05, confidence=0.90, maxlen = 5, minlen=2))
summary(rules)
reglas_Noredund <- rules[!is.redundant(x = rules, measure = "confidence")]
filtrado_reglas <- subset(x = reglas_Noredund,
subset = rhs %pin% "Exited=0")
filtrado_reglas_ordenadas <- sort(filtrado_reglas, by = "lift")
inspect(head(filtrado_reglas_ordenadas,10))
rules = apriori (data_tr, parameter = list (support=0.1, confidence=0.85, maxlen = 5, minlen=2))
rules = apriori (data_tr, parameter = list (support=0.1, confidence=0.85, maxlen = 5, minlen=2))
summary(rules)
reglas_Noredund <- rules[!is.redundant(x = rules, measure = "confidence")]
filtrado_reglas <- subset(x = reglas_Noredund,
subset = rhs %pin% "Exited=0")
filtrado_reglas_ordenadas <- sort(filtrado_reglas, by = "lift")
inspect(head(filtrado_reglas_ordenadas,10))
View(data_reducida)
