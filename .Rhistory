summarise(mean_O = mean(O), sd_O = sd(O), n = n(), .groups = "drop") %>%
mutate(se = sd_O / sqrt(n))
ggplot(df_summary, aes(x = as.factor(T), y = mean_O)) +
geom_point(size = 4, color = "blue") +
geom_errorbar(aes(ymin = mean_O - se, ymax = mean_O + se), width = 0.2) +
labs(
title = "Mitjana i error estàndard de l'Outcome per Tractament",
x = "Tractament (T)",
y = "Mitjana Outcome (O)"
) +
theme_minimal()
ggplot(df, aes(x = as.factor(T), y = O)) +
geom_boxplot(fill = "lightblue") +
labs(
title = "Distribució de l'Outcome segons Tractament",
x = "Tractament (T)",
y = "Outcome (O)"
) +
theme_minimal()
ggplot(df, aes(x = as.factor(T.), y = O)) +
geom_boxplot(fill = "lightblue") +
labs(
title = "Distribució de l'Outcome segons Tractament",
x = "Tractament (T)",
y = "Outcome (O)"
) +
theme_minimal()
library(ggplot2)
df <- data.frame(O = O, T. = T., Z = as.factor(Z))
ggplot(df, aes(x = T., y = O, color = Z)) +
geom_jitter(alpha = 0.2, width = 0.1) +
geom_smooth(method = "lm", se = FALSE) +
labs(title = "Regressió de l'Outcome segons Tractament i Z",
x = "Tractament (T)", y = "Outcome (O)", color = "Z") +
theme_minimal()
library(ggplot2)
ggplot(df, aes(x = as.factor(T.), y = O)) +
geom_boxplot(fill = "lightblue") +
labs(
title = "Distribució de l'Outcome segons Tractament",
x = "Tractament (T)",
y = "Outcome (O)"
) +
theme_minimal()
library(ggplot2)
# 确保 Z 是因子
df$Z <- as.factor(df$Z)
ggplot(df, aes(x = T., y = O, color = Z)) +
geom_jitter(width = 0.1, alpha = 0.3) +
geom_smooth(method = "lm", se = TRUE) +
labs(
title = "Relació entre Tractament i Outcome per grups de Z",
x = "Tractament (T.)",
y = "Outcome (O)",
color = "Z"
) +
theme_minimal()
ggplot(df, aes(x = as.factor(T.), y = O, fill = Z)) +
geom_boxplot(position = position_dodge(0.8)) +
labs(
title = "Distribució de l'Outcome per Tractament i grups de Z",
x = "Tractament (T.)",
y = "Outcome (O)",
fill = "Z"
) +
theme_minimal()
library(dplyr)
df_summary <- df %>%
group_by(Z, T.) %>%
summarise(mean_O = mean(O), sd_O = sd(O), n = n(), .groups = "drop") %>%
mutate(se = sd_O / sqrt(n))
ggplot(df_summary, aes(x = as.factor(T.), y = mean_O, color = Z, group = Z)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = mean_O - se, ymax = mean_O + se), width = 0.1) +
geom_line() +
labs(
title = "Mitjana d'Outcome per Tractament i grups de Z",
x = "Tractament (T.)",
y = "Mitjana Outcome (O)",
color = "Z"
) +
theme_minimal()
library(ggplot2)
ggplot(df, aes(x = as.factor(T.), y = O)) +
geom_boxplot(fill = "lightblue") +
labs(
title = "Mitjana d'Outcome segons Tractament",
x = "Tractament (T)",
y = "Outcome (O)"
) +
theme_minimal()
library(dplyr)
df_summary <- df %>%
group_by(Z, T.) %>%
summarise(mean_O = mean(O), sd_O = sd(O), n = n(), .groups = "drop") %>%
mutate(se = sd_O / sqrt(n))
ggplot(df_summary, aes(x = as.factor(T.), y = mean_O, color = Z, group = Z)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = mean_O - se, ymax = mean_O + se), width = 0.1) +
geom_line() +
labs(
title = "Mitjana d'Outcome per Tractament per grups de Z",
x = "Tractament (T)",
y = "Mitjana Outcome (O)",
color = "Z"
) +
theme_minimal()
library(ggplot2)
ggplot(df, aes(x = as.factor(T.), y = O)) +
geom_boxplot(fill = "lightblue", outlier.alpha = 0.2, width = 0.5) +
stat_summary(fun = mean, geom = "point", shape = 20, size = 3, color = "darkblue") +
labs(
title = "Distribució de l'Outcome segons Tractament",
x = "Tractament (T)",
y = "Outcome (O)"
) +
theme_minimal(base_size = 13) +
theme(
plot.title = element_text(face = "bold"),
axis.title = element_text(face = "bold")
)
library(ggplot2)
ggplot(df, aes(x = as.factor(T.), y = O)) +
geom_boxplot(fill = "#74add1", outlier.alpha = 0.15, width = 0.4) +
stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "white", color = "black") +
scale_x_discrete(labels = c("0", "1")) +
labs(
title = "Distribució de l'Outcome segons Tractament",
x = "Tractament (T)",
y = "Outcome (O)"
) +
theme_minimal(base_size = 13) +
theme(
plot.title = element_text(face = "bold", size = 14, hjust = 0.5),
axis.title = element_text(face = "bold"),
legend.position = "none"
)
adj_T1 <- mean(O[T. == 1 & Z == 1]) * mean(Z == 1) +
mean(O[T. == 1 & Z == 0]) * mean(Z == 0)
adj_T0 <- mean(O[T. == 0 & Z == 1]) * mean(Z == 1) +
mean(O[T. == 0 & Z == 0]) * mean(Z == 0)
adj_diff <- adj_T1 - adj_T0
print(paste("Adjustament(1) - Adjustament(0):", round(adj_diff, 4)))
print("ATE teòric: -0.2")
cond_prob_diff <- mean(O[T. == 1]) - mean(O[T. == 0])
print(paste("Observats E(O|T=1) - E(O|T=0):", round(cond_prob_diff, 4)))
adj_T1 <- mean(O[T. == 1 & Z == 1]) * mean(Z == 1) +
mean(O[T. == 1 & Z == 0]) * mean(Z == 0)
adj_T0 <- mean(O[T. == 0 & Z == 1]) * mean(Z == 1) +
mean(O[T. == 0 & Z == 0]) * mean(Z == 0)
adj_diff <- adj_T1 - adj_T0
print(paste("Adjustament(1) - Adjustament(0):", round(adj_diff, 4)))
print("ATE teòric: -0.2")
model <- lm(O ~ T. + Z)
summary(model)
library(ggplot2)
ggplot(df, aes(x = as.factor(T.), y = O)) +
geom_boxplot(fill = "lightblue") +
labs(
title = "Mitjana d'Outcome segons Tractament",
x = "Tractament (T)",
y = "Outcome (O)"
) +
theme_minimal()
library(dplyr)
df_summary <- df %>%
group_by(Z, T.) %>%
summarise(mean_O = mean(O), sd_O = sd(O), n = n(), .groups = "drop") %>%
mutate(se = sd_O / sqrt(n))
ggplot(df_summary, aes(x = as.factor(T.), y = mean_O, color = Z, group = Z)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = mean_O - se, ymax = mean_O + se), width = 0.1) +
geom_line() +
labs(
title = "Mitjana d'Outcome per Tractament per grups de Z",
x = "Tractament (T)",
y = "Mitjana Outcome (O)",
color = "Z"
) +
theme_minimal()
# Calcular covariància i variància
cov_TO <- cov(O, T.)
var_T <- var(T.)
# Estimació del coeficient beta_T
beta_T <- cov_TO / var_T
print(paste("Coeficient estimat manualment (T → O):", round(beta_T, 4)))
# Compareu amb lm()
summary(lm(O ~ T.))
```{r}
# Calcular covariància i variància
cov_TO <- cov(O, T.)
var_T <- var(T.)
# Estimació del coeficient beta_T
beta_T <- cov_TO / var_T
print(paste("Coeficient estimat manualment (T → O):", round(beta_T, 4)))
# Compareu amb lm()
summary(lm(O ~ T.))
cov_TO
var_T
beta_T
# install.packages("DiagrammeR")
library(DiagrammeR)
grViz("
digraph dag {
graph [layout = dot, rankdir = LR]
node [shape = box, style=filled, fillcolor=white, fontname = Helvetica]
Z [label='Z']
T [label='T']
O [label='O']
C [label='C', style='dashed']
C -> Z
C -> O
Z -> T
T -> O
}
")
# install.packages("DiagrammeR")
library(DiagrammeR)
grViz("
digraph dag {
graph [layout = dot, rankdir = LR]
node [shape = box, style=filled, fillcolor=white]
Z [label='Z']
T [label='T']
O [label='O']
C [label='C', style='dashed']
C -> Z
C -> O
Z -> T
T -> O
}
")
cond_prob_diff <- mean(O[T. == 1]) - mean(O[T. == 0])
print(paste("Efecte total E(O|T=1) - E(O|T=0):", round(cond_prob_diff, 4)))
library(ggplot2)
ggplot(df, aes(x = as.factor(T.), y = O)) +
geom_boxplot(fill = "lightblue") +
labs(
title = "Mitjana d'Outcome segons Tractament",
x = "Tractament (T)",
y = "Outcome (O)"
) +
theme_minimal()
library(dplyr)
df_summary <- df %>%
group_by(Z, T.) %>%
summarise(mean_O = mean(O), sd_O = sd(O), n = n(), .groups = "drop") %>%
mutate(se = sd_O / sqrt(n))
ggplot(df_summary, aes(x = as.factor(T.), y = mean_O, color = Z, group = Z)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = mean_O - se, ymax = mean_O + se), width = 0.1) +
geom_line() +
labs(
title = "Mitjana d'Outcome per Tractament per grups de Z",
x = "Tractament (T)",
y = "Mitjana Outcome (O)",
color = "Z"
) +
theme_minimal()
model <- lm(O ~ T. + Z)
summary(model)
library(ggplot2)
ggplot(df, aes(x = as.factor(T.), y = O)) +
geom_boxplot(fill = "lightblue") +
labs(
title = "Mitjana d'Outcome segons Tractament",
x = "Tractament (T)",
y = "Outcome (O)"
) +
theme_minimal()
library(dplyr)
df_summary <- df %>%
group_by(Z, T.) %>%
summarise(mean_O = mean(O), sd_O = sd(O), n = n(), .groups = "drop") %>%
mutate(se = sd_O / sqrt(n))
ggplot(df_summary, aes(x = as.factor(T.), y = mean_O, color = Z, group = Z)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = mean_O - se, ymax = mean_O + se), width = 0.1) +
geom_line() +
labs(
title = "Mitjana d'Outcome per Tractament per grups de Z",
x = "Tractament (T)",
y = "Mitjana Outcome (O)",
color = "Z"
) +
theme_minimal()
adj_T1 <- mean(O[T. == 1 & Z == 1]) * mean(Z == 1) +
mean(O[T. == 1 & Z == 0]) * mean(Z == 0)
adj_T0 <- mean(O[T. == 0 & Z == 1]) * mean(Z == 1) +
mean(O[T. == 0 & Z == 0]) * mean(Z == 0)
adj_diff <- adj_T1 - adj_T0
print(paste("Adjustament(1) - Adjustament(0):", round(adj_diff, 4)))
print("ATE teòric: -0.2")
library(ggplot2)
ggplot(df, aes(x = as.factor(T.), y = O)) +
geom_boxplot(fill = "lightblue") +
labs(
title = "Mitjana d'Outcome segons Tractament",
x = "Tractament (T)",
y = "Outcome (O)"
) +
theme_minimal()
library(ggplot2)
df <- data.frame(O = O, T. = T., Z = Z)
ggplot(df, aes(x = as.factor(T.), y = O)) +
geom_boxplot(fill = "lightblue") +
labs(
title = "Mitjana d'Outcome segons Tractament",
x = "Tractament (T)",
y = "Outcome (O)"
) +
theme_minimal()
library(ggdag)
dag <- dagify(
Z ~ C,
T ~ Z,
O ~ T + C,
exposure = "T",
outcome = "O",
latent = "C"
)
ggdag(dag, use_labels = "name") +
theme_dag()
# install.packages("DiagrammeR")
library(DiagrammeR)
grViz("
digraph dag {
graph [layout = dot, rankdir = LR]
node [shape = box, style=filled, fillcolor=white]
Z [label='Z']
T [label='T']
O [label='O']
C [label='C', style='dashed']
C -> Z
C -> O
Z -> T
T -> O
}
")
library(dplyr)
df_summary <- df %>%
group_by(Z, T.) %>%
summarise(mean_O = mean(O), sd_O = sd(O), n = n(), .groups = "drop") %>%
mutate(se = sd_O / sqrt(n))
ggplot(df_summary, aes(x = as.factor(T.), y = mean_O, color = factor(Z), group = Z)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = mean_O - se, ymax = mean_O + se), width = 0.1) +
geom_line() +
labs(
title = "Mitjana d'Outcome per Tractament per grups de Z",
x = "Tractament (T)",
y = "Mitjana Outcome (O)",
color = "Z"
) +
theme_minimal()
knitr::opts_chunk$set(echo = TRUE)
library(sqldf)
library(sqldf)
library(sqldf)
train_data<-read.csv2("DATA/train.csv", sep=",")
setwd("C:/Users/95409/OneDrive/ESTADISTICA/4r/1/MD/Mineria")
psych::describe(datos[, varNum])
library(psych)
psych::describe(datos[, varNum])
install.packages("psych")
psych::describe(datos[, varNum])
train_data<-read.csv2("DATA/train.csv", sep=",")
test_data<-read.csv2("DATA/test.csv", sep=",")
submit_data<-read.csv2("DATA/sample_submission.csv", sep=",")
psych::describe(train_data[, varNum])
# install.packages("psych")
install.packages("dlookr")
# install.packages("psych")
# install.packages("dlookr")
library(dlookr)
dlookr::diagnose(dades)
dlookr::diagnose(dades)
dlookr::diagnose(train_data)
dlookr::diagnose(train_data)
head(overview((train_data), n = 10))
head(overview(train_data), n = 10)
overview(train_data)
dlookr::diagnose(train_data)
dlookr::diagnose(train_data, n = 20)
dlookr::diagnose(train_data, n = 24)
print(n=24)
dlookr::diagnose(train_data)
print(n=24)
# Limieza de los datos a nivel de variable
summary(train_data)
## ==== Automatic Descriptive Analysis (EDA) ====
library(skimr)
library(tidyverse)
## Podem visualitzar un descriptiu de les dades
skim(train_data)
## ==== Automatic Descriptive Analysis (EDA) ====
install.packages("skimr")
library(skimr)
library(skimr)
library(tidyverse)
install.packages("tidyverse")
library(skimr)
library(tidyverse)
## Podem visualitzar un descriptiu de les dades
skim(train_data)
## Podem visualitzar un descriptiu de les dades
skim(train_data)
clases <- sapply(train_data, class)
clases
clases <- sapply(train_data, class)
clases
head(train_data)
head(train_data)
clases
head(test_data)
head(train_data)
colnames(train_data)
colnames(test_data)
colsfactor <- c(
"CustomerSegment", "Gender", "MaritalStatus", "EducationLevel",
"HasCrCard", "SavingsAccountFlag", "LoanStatus", "TransactionFrequency",
"DigitalEngagementScore", "ComplaintsCount", "NetPromoterScore", "Exited"
)
data[colsfactor] <- lapply(data[colsfactor], as.factor)
colsfactor <- c(
"CustomerSegment", "Gender", "MaritalStatus", "EducationLevel",
"HasCrCard", "SavingsAccountFlag", "LoanStatus", "TransactionFrequency",
"DigitalEngagementScore", "ComplaintsCount", "NetPromoterScore", "Exited"
)
clases
data[colsfactor] <- lapply(data[colsfactor], as.factor)
colsfactor <- c(
"CustomerSegment", "Gender", "MaritalStatus", "EducationLevel",
"HasCrCard", "SavingsAccountFlag", "LoanStatus", "TransactionFrequency",
"DigitalEngagementScore", "ComplaintsCount", "NetPromoterScore", "Exited"
)
data[colsfactor] <- lapply(data[colsfactor], as.factor)
colsfactor <- c(
"CustomerSegment", "Gender", "MaritalStatus", "EducationLevel",
"HasCrCard", "SavingsAccountFlag", "LoanStatus", "TransactionFrequency",
"DigitalEngagementScore", "ComplaintsCount", "NetPromoterScore", "Exited"
)
data[,colsfactor] <- lapply(data[,colsfactor], as.factor)
colsfactor <- c(
"CustomerSegment", "Gender", "MaritalStatus", "EducationLevel",
"HasCrCard", "SavingsAccountFlag", "LoanStatus", "TransactionFrequency",
"DigitalEngagementScore", "ComplaintsCount", "NetPromoterScore", "Exited"
)
data[[colsfactor]] <- lapply(data[[colsfactor]], as.factor)
clases
colsfactor <- c(
"CustomerSegment", "Gender", "MaritalStatus", "EducationLevel",
"HasCrCard", "SavingsAccountFlag", "LoanStatus", "TransactionFrequency",
"DigitalEngagementScore", "ComplaintsCount", "NetPromoterScore", "Exited"
)
data[colsfactor] <- lapply(data[colsfactor], as.factor)
data<-train_data
colsfactor <- c(
"CustomerSegment", "Gender", "MaritalStatus", "EducationLevel",
"HasCrCard", "SavingsAccountFlag", "LoanStatus", "TransactionFrequency",
"DigitalEngagementScore", "ComplaintsCount", "NetPromoterScore", "Exited"
)
data[colsfactor] <- lapply(data[colsfactor], as.factor)
varCat <- c(
"CustomerSegment", "Gender", "MaritalStatus", "EducationLevel",
"HasCrCard", "SavingsAccountFlag", "LoanStatus", "TransactionFrequency",
"DigitalEngagementScore", "ComplaintsCount", "NetPromoterScore", "Exited"
)
data[varCat] <- lapply(data[varCat], as.factor)
train_data<-read.csv2("DATA/train.csv", sep=",")
test_data<-read.csv2("DATA/test.csv", sep=",")
submit_data<-read.csv2("DATA/sample_submission.csv", sep=",")train_data<-read.csv2("DATA/train.csv", sep=",")
varNum <- c(
"EstimatedSalary", "CreditScore", "Tenure", "Balance", "NumOfProducts"
)
varCat <- c(
"CustomerSegment", "Gender", "MaritalStatus", "EducationLevel",
"HasCrCard", "SavingsAccountFlag", "LoanStatus", "TransactionFrequency",
"DigitalEngagementScore", "ComplaintsCount", "NetPromoterScore", "Exited"
)
data[varCat] <- lapply(data[varCat], as.factor)
## Podem visualitzar un descriptiu de les dades
skim(data)
clases <- sapply(train_data, class)
head(train_data)
head(test_data)
# variables categoricas y numéricas
## paso 0  prueba : data<-train_data
varCat <- c(
"CustomerSegment", "Gender", "MaritalStatus", "EducationLevel",
"HasCrCard", "SavingsAccountFlag", "LoanStatus", "TransactionFrequency",
"DigitalEngagementScore", "ComplaintsCount", "NetPromoterScore", "Exited"
)
data[varCat] <- lapply(data[varCat], as.factor)
data[varCat] <- lapply(data[varCat], as.factor)
data<-train_data
varCat <- c(
"CustomerSegment", "Gender", "MaritalStatus", "EducationLevel",
"HasCrCard", "SavingsAccountFlag", "LoanStatus", "TransactionFrequency",
"DigitalEngagementScore", "ComplaintsCount", "NetPromoterScore", "Exited"
)
data[varCat] <- lapply(data[varCat], as.factor)
varNum <- c(
"EstimatedSalary", "CreditScore", "Tenure", "Balance", "NumOfProducts"
)
## ==== AED ====
# install.packages("skimr")
# install.packages("tidyverse")
library(skimr)
library(tidyverse)
## Podem visualitzar un descriptiu de les dades
skim(data)
