---
title: "preprocessing univ"
output: html_document
date: "2025-10-01"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Detección de outliers univariante: variables numéricas
Ejecutar reading_data.R antes
```{r}
install.packages("lawstat")
library(lawstat)
library(ggplot2)
library(moments)
```
Variables a estudiar:
```{r}
varNum<-c("Age", "CreditScore", "Tenure","EstimatedSalary", "Balance", "NumOfProducts",
          "TransactionFrequency","AvgTransactionAmount","DigitalEngagementScore",
          "ComplaintsCount","NetPromoterScore")
```

Primero ejecutamos un test de simetría para saber qué método usar para la detección de outliers en cada variable.
```{r}
p<-sapply(varNum, function(v) symmetry.test(data[[v]])$p.value)
symmetry_test <- data.frame(
  p.value = p,
  significative=(p<0.05)
)
symmetry_test <- symmetry_test[order(symmetry_test$p.value), ]
print(symmetry_test)
```
Parece que únicamente CreditScore, TransactionFrequency, Tenure y EstimatedSalary han soportado el test y pueden ser consideradas simétricas. No obstante, el p-valor de CreditScore y quizás el de TransactionFrequency merecen una inspección más a fondo.

Todas las variables con p-valor inferior a 0.05 rechazan claramente simetría.

Ahora, para reafirmar o terminar de definir las conclusiones de este test, realizaremos una inspección visual de las distribuciones para evaluar su simetría:

```{r}
n_vars <- length(varNum)
ncol <- 2
nrow <- ceiling(n_vars / ncol)

par(mfrow = c(nrow, ncol))

for (var in varNum) {
  hist(data[[var]], 
       main = paste(var),
       xlab = var,
       col = "lightblue",
       breaks = 20)
}

par(mfrow = c(1, 1))
```
Pese a que TransactionFrequency, Tenure y EstimatedSalary pueden ser validadas como simétricas, CreditScore es algo confusa. Realizaremos un último test:
```{r}
skewness(data$CreditScore, na.rm = TRUE)
```
El valor, muy cercano a 0, de la prueba de Fisher nos permite confirmar CreditScore como variable simétrica.

No obstante, ha aparecido una duda. La distribución de Balance parece mostrar la existencia de dos poblaciones. Aproximadamente un 25% de la población tiene su cuenta en 0, y el resto parece distribuirse de manera ciertamente simétrica.
```{r}
sum(data$Balance == 0, na.rm = TRUE)
```
```{r}
symmetric<-c("TransactionFrequency", "Tenure", "EstimatedSalary")
non_symmetric<-c("Age","NumOfProducts","AvgTransactionAmount","DigitalEngagementScore","ComplaintsCount", "NetPromoterScore")

```

