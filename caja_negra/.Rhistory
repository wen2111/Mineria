load("C:/Users/34688/OneDrive - Universitat de Barcelona/Escritorio/Mineria/DATA/data.RData")
# 1.1 Numérica
library(psych)
psych::describe(data[, varNum])
##Gráficos
### base
par(mfrow = c(2, 4))
for (var in varNum) {
hist(data[, var], main = paste0("Histograma ", var))
boxplot(data[, var], main = paste0("Boxplot ", var))
}
##Gráficos
### base
par(mfrow = c(2, 4))
for (var in varNum) {
hist(data[, var], main = paste0("Histograma ", var))
boxplot(data[, var], main = paste0("Boxplot ", var))
}
psych::describe(data[, varNum])
psych::describe(data[, varNum])
# 1.2 Categórica
## Descriptivo
for (var in varCat) {
tablaAbs <- data.frame(table(data[, var]))
tablaFreq <- data.frame(table(data[, var])/sum(table(data[, var])))
m <- match(tablaAbs$Var1, tablaFreq$Var1)
tablaAbs[, "FreqRel"] <- tablaFreq[m, "Freq"]
colnames(tablaAbs) <- c("Categoria", "FreqAbs", "FreqRel")
cat("===============", var, "===================================\n")
print(tablaAbs)
cat("==================================================\n")
}
cor(data[, varNum],use = "pairwise.complete.obs")
corPlot(data[, varNum])
corPlot(data[, varNum])
cor(data[, varNum],use = "pairwise.complete.obs")
corPlot(data[, varNum])
# relacion entre exited (var resposta) i las categoricas
cat<-varCat[-10]
v<-"Exited"
for (varc1 in cat) {
if (varc1 != v) {
prop_table <- prop.table(table(data[, v], data[, varc1]),margin = 2)
print(prop_table)
barplot(prop_table, beside = TRUE,main = paste0(v,"&",varc1))
}
}
for (varc1 in cat) {
if (varc1 != v) {
tab <- table(data[[v]], data[[varc1]])  # filas = Exited, columnas = categorías
test <- chisq.test(tab, correct = FALSE)
cat("\nVariable:", varc1, "\n")
cat("Chi-squared =", round(test$statistic, 3),
"df =", test$parameter,
"p-value =", signif(test$p.value, 5), "\n")
if (test$p.value < 0.05) cat("-> Diferencias significativas entre columnas\n")
}
}
for (var in varNum) {
p <- ggplot(data, aes(x = factor(Exited), y = .data[[var]], fill = factor(Exited))) +
geom_boxplot(alpha = 0.7, na.rm = TRUE) +
labs(x = "Exited",
y = var,
title = paste("Distribución de", var, "por Exited")) +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
print(p)
}
for (varc1 in varCat) {
for (varc2 in varCat) {
if (varc1 != varc2) {
prop_table <- prop.table(table(data[, varc1], data[, varc2]),margin = 2)
cat("=============", varc1, " vs. ", varc2, "=========================\n")
print(prop_table)
}
}
}
# relacion entre exited (var resposta) i las categoricas
cat<-varCat[-10]
v<-"Exited"
for (varc1 in cat) {
if (varc1 != v) {
prop_table <- prop.table(table(data[, v], data[, varc1]),margin = 2)
print(prop_table)
barplot(prop_table, beside = TRUE,main = paste0(v,"&",varc1))
}
}
# relacion entre exited (var resposta) i las categoricas
cat<-varCat[-10]
v<-"Exited"
for (varc1 in cat) {
if (varc1 != v) {
prop_table <- prop.table(table(data[, v], data[, varc1]),margin = 2)
print(prop_table)
barplot(prop_table, beside = TRUE,main = paste0(v,"&",varc1))
}
}
# relacion entre exited (var resposta) i las categoricas
par(mfrow = c(3, 3))
cat<-varCat[-10]
v<-"Exited"
for (varc1 in cat) {
if (varc1 != v) {
prop_table <- prop.table(table(data[, v], data[, varc1]),margin = 2)
print(prop_table)
barplot(prop_table, beside = TRUE,main = paste0(v,"&",varc1))
}
}
par(mfrow = c(2, 2))
for (varc1 in varCat) {
for (varc2 in varCat) {
if (varc1 != varc2) {
prop_table <- prop.table(table(data[, varc1], data[, varc2]),margin =2 )
barplot(prop_table, beside = TRUE,main = paste0(varc1,"&",varc2))
}
}
}
vis_miss(data)
library(visdat)
vis_miss(data)
library(naniar)
naniar::mcar_test(data)
na_por_fila <- rowSums(is.na(data))
filas__miss <- which(na_por_fila >= 11)
s<-data[filas_15_miss,]
sum(s$group=="test") # hay 212 individuos con 11 o mas missings
filas_miss <- which(na_por_fila >= 11)
s<-data[filas_miss,]
sum(s$group=="test") # hay 212 individuos con 11 o mas missings
na_por_fila <- rowSums(is.na(data))
filas_miss <- which(na_por_fila >= 11)
na_por_fila <- rowSums(is.na(data))
na_por_fila <- rowSums(is.na(data))
filas_miss <- which(na_por_fila >= 15)
s<-data[filas_miss,]
sum(s$group=="test") # hay 212 individuos con 11 o mas missings
load("C:/Users/34688/OneDrive - Universitat de Barcelona/Escritorio/Mineria/Entrega_1/data_ar.RData")
View(data_ar)
