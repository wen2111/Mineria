print(p)
}
}
}
par(mfrow = c(3, 3))
for (varc1 in varCat) {
for (varc2 in varCat) {
if (varc1 != varc2) {
prop_table <- prop.table(table(data[, varc1], data[, varc2]))
barplot(prop_table, beside = TRUE,main = paste0(varc1,"&",varc2))
legend("topright", legend = colnames(prop_table),
fill = rainbow(ncol(prop_table)),
cex = 0.8)
}
}
}
par(mfrow = c(3, 3))
for (varc1 in varCat) {
for (varc2 in varCat) {
if (varc1 != varc2) {
prop_table <- prop.table(table(data[, varc1], data[, varc2]))
barplot(prop_table, beside = TRUE,main = paste0(varc1,"&",varc2),col = rainbow(ncol(prop_table)))
legend("topright", legend = colnames(prop_table),
fill = rainbow(ncol(prop_table)),
cex = 0.8)
}
}
}
for (varc1 in varCat) {
for (varc2 in varCat) {
if (varc1 != varc2) {
prop_table <- prop.table(table(data[, varc1], data[, varc2]))
barplot(prop_table, beside = TRUE,main = paste0(varc1,"&",varc2),col = rainbow(ncol(prop_table)))
legend("topright", legend = colnames(prop_table),
fill = rainbow(ncol(prop_table)),
cex = 0.8,xpd = TRUE)
}
}
}
for (varc1 in varCat) {
for (varc2 in varCat) {
if (varc1 != varc2) {
prop_table <- prop.table(table(data[, varc1], data[, varc2]))
barplot(prop_table, beside = TRUE,main = paste0(varc1,"&",varc2),col = rainbow(ncol(prop_table)))
legend("topright", legend = rownames(prop_table),
fill = rainbow(ncol(prop_table)),
cex = 0.8,xpd = TRUE)
}
}
}
for (varc1 in varCat) {
for (varc2 in varCat) {
if (varc1 != varc2) {
prop_table <- prop.table(table(data[, varc1], data[, varc2]))
barplot(prop_table, beside = TRUE,main = paste0(varc1,"&",varc2),col = rainbow(ncol(prop_table)))
legend("topright", legend = rownames(prop_table),
fill = rainbow(ncol(prop_table)),
cex = 0.8,inset = c(-0.5,1))
}
}
}
for (varc1 in varCat) {
for (varc2 in varCat) {
if (varc1 != varc2) {
prop_table <- prop.table(table(data[, varc1], data[, varc2]))
barplot(prop_table, beside = TRUE,main = paste0(varc1,"&",varc2),col = rainbow(ncol(prop_table)))
legend("topright", legend = rownames(prop_table),
fill = rainbow(ncol(prop_table)),
cex = 0.8,inset = c(-0.5,0))
}
}
}
for (varc1 in varCat) {
for (varc2 in varCat) {
if (varc1 != varc2) {
prop_table <- prop.table(table(data[, varc1], data[, varc2]))
barplot(prop_table, beside = TRUE,main = paste0(varc1,"&",varc2),col = rainbow(ncol(prop_table)))
legend("topright", legend = rownames(prop_table),
fill = rainbow(ncol(prop_table)),
cex = 0.8,inset = c(-0.2,0))
}
}
}
for (varc1 in varCat) {
for (varc2 in varCat) {
if (varc1 != varc2) {
prop_table <- prop.table(table(data[, varc1], data[, varc2]))
barplot(prop_table, beside = TRUE,main = paste0(varc1,"&",varc2),col = rainbow(ncol(prop_table)))
legend("topright", legend = rownames(prop_table),
fill = rainbow(ncol(prop_table)),
cex = 0.8,inset = c(-0.1,0))
}
}
}
for (varc1 in varCat) {
for (varc2 in varCat) {
if (varc1 != varc2) {
prop_table <- prop.table(table(data[, varc1], data[, varc2]))
barplot(prop_table, beside = TRUE,main = paste0(varc1,"&",varc2),col = rainbow(ncol(prop_table)))
legend("topleft", legend = rownames(prop_table),
fill = rainbow(ncol(prop_table)),
cex = 0.8,inset = c(-0.1,0))
}
}
}
for (varc1 in varCat) {
for (varc2 in varCat) {
if (varc1 != varc2) {
prop_table <- prop.table(table(data[, varc1], data[, varc2]))
barplot(prop_table, beside = TRUE,main = paste0(varc1,"&",varc2),col = rainbow(ncol(prop_table)))
legend("topleft", legend = rownames(prop_table),
fill = rainbow(ncol(prop_table)),
cex = 0.8,inset = c(0.1,0))
}
}
}
for (varc1 in varCat) {
for (varc2 in varCat) {
if (varc1 != varc2) {
prop_table <- prop.table(table(data[, varc1], data[, varc2]))
barplot(prop_table, beside = TRUE,main = paste0(varc1,"&",varc2))
}
}
}
plot(data$Exited,data$NetPromoterScore)
plot(data$Exited,data$NetPromoterScore)
plot(data$NetPromoterScore,data$Exited)
plot(data$NetPromoterScore,data$Exited)
## Num VS Cat
ggplot(data, aes(x = factor(categoria), y = numerica, fill = factor(categoria))) +
geom_boxplot(alpha = 0.6, outlier.shape = NA) +
geom_jitter(width = 0.15, color = "black", alpha = 0.5) +
labs(x = "Categoría", y = "Valor numérico",
title = "Boxplot + puntos individuales") +
theme_minimal()
## Num VS Cat
ggplot(data, aes(x = factor(Exited), y = NetPromoterScore, fill = factor(Exited))) +
geom_boxplot(alpha = 0.7) +
labs(x = "Exited",
y = "Net Promoter Score",
title = "Distribución de NetPromoterScore por estado de salida (Exited)") +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
ggplot(data, aes(x = factor(Exited), y = NetPromoterScore, fill = factor(Exited))) +
geom_violin(trim = FALSE, alpha = 0.7) +
geom_boxplot(width = 0.1, fill = "white") +
labs(x = "Exited",
y = "Net Promoter Score",
title = "Distribución (violin plot) de NetPromoterScore por Exited") +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
ggplot(data, aes(x = factor(Exited), y = NetPromoterScore, fill = factor(Exited))) +
stat_summary(fun = mean, geom = "bar", color = "black", alpha = 0.8) +
stat_summary(fun.data = mean_se, geom = "errorbar", width = 0.2) +
labs(x = "Exited",
y = "Promedio de Net Promoter Score",
title = "Promedio de NetPromoterScore según Exited") +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
ggplot(data, aes(x = factor(Exited), y = NetPromoterScore, fill = factor(Exited))) +
geom_boxplot(alpha = 0.6, outlier.shape = NA) +
geom_jitter(width = 0.15, alpha = 0.5, color = "black") +
labs(x = "Exited",
y = "Net Promoter Score",
title = "Distribución detallada de NetPromoterScore por Exited") +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
summary(data$Exited)
ggplot(data, aes(x = factor(Exited), y = NetPromoterScore, fill = factor(Exited))) +
geom_violin(trim = FALSE, alpha = 0.7) +
geom_boxplot(width = 0.1, fill = "white") +
labs(x = "Exited",
y = "Net Promoter Score",
title = "Distribución (violin plot) de NetPromoterScore por Exited") +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
data$NetPromoterScore
summary(data$NetPromoterScore)
## Num VS Cat
ggplot(data, aes(x = factor(Exited), y = NetPromoterScore, fill = factor(Exited))) +
geom_boxplot(alpha = 0.7) +
labs(x = "Exited",
y = "Net Promoter Score",
title = "Distribución de NetPromoterScore por estado de salida (Exited)") +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
ggplot(data, aes(x = factor(Exited), y = NetPromoterScore, fill = factor(Exited))) +
geom_violin(trim = FALSE, alpha = 0.7) +
geom_boxplot(width = 0.1, fill = "white") +
labs(x = "Exited",
y = "Net Promoter Score",
title = "Distribución (violin plot) de NetPromoterScore por Exited") +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
##Gráficos
### base
par(mfrow = c(2, 4))
for (var in varNum) {
hist(data[, var], main = paste0("Histograma variable ", var))
boxplot(data[, var], main = paste0("Boxplot variable ", var))
}
for (var in varNum) {
hist(data[, var], main = paste0("Histograma ", var))
boxplot(data[, var], main = paste0("Boxplot ", var))
}
# Crear listas separadas
plots_histo <- list()
plots_box <- list()
for (var in varNum) {
binwidth_value <- diff(range(data[[var]])) / 30
histo <- ggplot(data, aes(x = .data[[var]])) +
geom_histogram(aes(y = ..density..), colour = "black", fill = "white", binwidth = binwidth_value) +
geom_density(alpha = .2, fill = "#FF6666") +
geom_vline(aes(xintercept = mean(.data[[var]], na.rm = TRUE)),
color = "blue", linetype = "dashed", linewidth = 1) +
ggtitle(paste("Histograma de", var))
boxp <- ggplot(data, aes(x = .data[[var]])) +
geom_boxplot(outlier.colour = "red", outlier.shape = 8, outlier.size = 4) +
ggtitle(paste("Boxplot de", var))
plots_histo <- append(plots_histo, list(histo))
plots_box <- append(plots_box, list(boxp))
}
dev.new()
final_histo <- Reduce(`+`, plots_histo) + plot_layout(ncol = 2)
final_box <- Reduce(`+`, plots_box) + plot_layout(ncol = 2)
final_histo
ggplot(data, aes(x = factor(Exited), y = NetPromoterScore, fill = factor(Exited))) +
geom_boxplot(alpha = 0.7) +
labs(x = "Exited",
y = "Net Promoter Score",
title = "Distribución de NetPromoterScore por estado de salida (Exited)") +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
for (var in varNum) {
# Filtrar NA en la variable numérica y en Exited
data_clean <- data[!is.na(data[[var]]) & !is.na(data$Exited), ]
# Crear el gráfico
p <- ggplot(data_clean, aes(x = factor(Exited), y = .data[[var]], fill = factor(Exited))) +
geom_boxplot(alpha = 0.7, outlier.shape = NA) +
geom_jitter(width = 0.15, alpha = 0.5, color = "black") + # opcional: mostrar puntos individuales
labs(x = "Exited",
y = var,
title = paste("Distribución de", var, "por estado de salida (Exited)")) +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
print(p)
}
for (var in varNum) {
# Filtrar NA en la variable numérica y en Exited
data_clean <- data[!is.na(data[[var]]) & !is.na(data$Exited), ]
# Crear el gráfico
p <- ggplot(data_clean, aes(x = factor(Exited), y = .data[[var]], fill = factor(Exited))) +
geom_boxplot(alpha = 0.7, outlier.shape = NA) +
geom_jitter(width = 0.15, alpha = 0.5, color = "black") + # opcional: mostrar puntos individuales
labs(x = "Exited",
y = var,
title = paste("Distribución de", var, "por estado de salida (Exited)")) +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
print(p)
}
for (var in varNum) {
# Crear gráfico filtrando NA sobre la marcha
p <- ggplot(data, aes(x = factor(Exited), y = .data[[var]], fill = factor(Exited))) +
geom_boxplot(alpha = 0.7, outlier.shape = NA, na.rm = TRUE) +
geom_jitter(width = 0.15, alpha = 0.5, color = "black", na.rm = TRUE) +
labs(x = "Exited",
y = var,
title = paste("Distribución de", var, "por estado de salida (Exited)")) +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
print(p)
}
for (var in varNum) {
# Crear gráfico filtrando NA sobre la marcha
p <- ggplot(data, aes(x = factor(Exited), y = .data[[var]], fill = factor(Exited))) +
geom_boxplot(alpha = 0.7, outlier.shape = NA, na.rm = TRUE) +
geom_jitter(width = 0.15, alpha = 0.5, color = "black", na.rm = TRUE) +
labs(x = "Exited",
y = var,
title = paste("Distribución de", var, "por estado de salida (Exited)")) +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
print(p)
}
for (var in varNum) {
p<-ggplot(data, aes(x = factor(Exited), y = varNum, fill = factor(Exited))) +
geom_boxplot(alpha = 0.7) +
labs(x = "Exited",
y = varNum,
title = paste("Exited","&",varNum)) +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
print(p)
}
for (var in varNum) {
p<-ggplot(data, aes(x = factor(Exited), y = varNum, fill = factor(Exited))) +
geom_boxplot(alpha = 0.7) +
labs(x = "Exited",
y = varNum,
title = paste("Exited","&",varNum)) +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
print(p)
}
for (var in varNum) {
p<-ggplot(data, aes(x = factor(Exited), y = varNum, fill = factor(Exited))) +
geom_boxplot(alpha = 0.7) +
labs(x = "Exited",
y = varNum,
title = paste("Exited","&",varNum)) +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
print(p)
}
ggplot(data, aes(x = factor(Exited), y = NetPromoterScore, fill = factor(Exited))) +
geom_boxplot(alpha = 0.7) +
labs(x = "Exited",
y = "Net Promoter Score",
title = "Distribución de NetPromoterScore por estado de salida (Exited)") +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
ggplot(data, aes(x = factor(Exited), y = NetPromoterScore, fill = factor(Exited))) +
geom_violin(trim = FALSE, alpha = 0.7) +
geom_boxplot(width = 0.1, fill = "white") +
labs(x = "Exited",
y = "Net Promoter Score",
title = "Distribución (violin plot) de NetPromoterScore por Exited") +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
for (var in varNum) {
# Crear gráfico filtrando NA sobre la marcha
p <- ggplot(data, aes(x = factor(Exited), y = .data[[var]], fill = factor(Exited))) +
geom_boxplot(alpha = 0.7, outlier.shape = NA, na.rm = TRUE) +
labs(x = "Exited",
y = var,
title = paste("Distribución de", var, "por estado de salida (Exited)")) +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
print(p)
}
ggplot(data, aes(x = factor(Exited), y = NetPromoterScore, fill = factor(Exited))) +
geom_violin(trim = FALSE, alpha = 0.7) +
geom_boxplot(width = 0.1, fill = "white") +
labs(x = "Exited",
y = "Net Promoter Score",
title = "Distribución (violin plot) de NetPromoterScore por Exited") +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
ggplot(data, aes(x = factor(Exited), y = NetPromoterScore, fill = factor(Exited))) +
geom_boxplot(alpha = 0.7) +
labs(x = "Exited",
y = "Net Promoter Score",
title = "Distribución de NetPromoterScore por estado de salida (Exited)") +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
for (var in varNum) {
p<-ggplot(data, aes(x = factor(Exited), y = NetPromoterScore, fill = factor(Exited))) +
geom_boxplot(alpha = 0.7) +
labs(x = "Exited",
y = "Net Promoter Score",
title = paste("Distribución de", var, "por Exited")) +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal
print(p)
}
for (var in varNum) {
p<-ggplot(data, aes(x = factor(Exited), y = NetPromoterScore, fill = factor(Exited))) +
geom_boxplot(alpha = 0.7) +
labs(x = "Exited",
y = "Net Promoter Score",
title = paste("Distribución de", var, "por Exited")) +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
print(p)
}
for (var in varNum) {
p<-ggplot(data, aes(x = factor(Exited), y = NetPromoterScore, fill = factor(Exited))) +
geom_boxplot(alpha = 0.7) +
labs(x = "Exited",
y = "Net Promoter Score",
title = paste("Distribución de", var, "por Exited")) +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
print(p)
}
for (var in varNum) {
p<-ggplot(data, aes(x = factor(Exited), y = varNum, fill = factor(Exited))) +
geom_boxplot(alpha = 0.7) +
labs(x = "Exited",
y = "Net Promoter Score",
title = paste("Distribución de", var, "por Exited")) +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
print(p)
}
for (var in varNum) {
p<-ggplot(data, aes(x = factor(Exited), y = var, fill = factor(Exited))) +
geom_boxplot(alpha = 0.7) +
labs(x = "Exited",
y = "Net Promoter Score",
title = paste("Distribución de", var, "por Exited")) +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
print(p)
}
for (var in varNum) {
p<-ggplot(data, aes(x = factor(Exited), y = var, fill = factor(Exited))) +
geom_boxplot(alpha = 0.7) +
labs(x = "Exited",
y = var,
title = paste("Distribución de", var, "por Exited")) +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
print(p)
}
ggplot(data, aes(x = factor(Exited), y = NetPromoterScore, fill = factor(Exited))) +
geom_boxplot(alpha = 0.7) +
labs(x = "Exited",
y = "Net Promoter Score",
title = "Distribución de NetPromoterScore por estado de salida (Exited)") +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
#violinplot
ggplot(data, aes(x = factor(Exited), y = NetPromoterScore, fill = factor(Exited))) +
geom_violin(trim = FALSE, alpha = 0.7) +
geom_boxplot(width = 0.1, fill = "white") +
labs(x = "Exited",
y = "Net Promoter Score",
title = "Distribución (violin plot) de NetPromoterScore por Exited") +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
for (var in varNum) {
# Crear gráfico filtrando NA sobre la marcha
p <- ggplot(data, aes(x = factor(Exited), y = .data[[var]], fill = factor(Exited))) +
geom_boxplot(alpha = 0.7, outlier.shape = NA, na.rm = TRUE) +
labs(x = "Exited",
y = var,
title = paste("Distribución de", var, "por estado de salida (Exited)")) +
scale_fill_manual(values = c("#66CC99", "#FF6666"),
name = "Exited",
labels = c("No", "Sí")) +
theme_minimal()
print(p)
}
library(visdat)
vis_miss(datos)
vis_miss(data)
na_por_fila <- rowSums(is.na(data))
filas_15_miss <- which(na_por_fila >= 15)
data[filas_15_miss, ]
data[filas_15_miss, ]
filas_15_miss <- which(na_por_fila >= 14)
data[filas_15_miss, ]
filas_15_miss <- which(na_por_fila >= 15)
data[filas_15_miss, ]
